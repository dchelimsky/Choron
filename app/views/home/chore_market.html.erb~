<h1>Chore market</h1>
<div id="views">
Now viewing <%= @view %> auctions. View:
  <%= link_to 'Open', :controller => "home", :action => "chore_market", :view => 'open' %> |
  <%= link_to 'Closed', :controller => "home", :action => "chore_market", :view => 'closed' %> |
  <%= link_to 'All', :controller => "home", :action => "chore_market", :view => 'all' %>
</div>

<table>
  <tr>
    <th>Chore name</th>
    <th>Auction expires</th>
    <th>Chore due</th>
    <th></th>
    <th></th>
  </tr>

<% @chores.each do |chore| %>
  <% if (@view=='open' and chore.auction.expiration_date.future?) or (@view=='closed' and chore.auction.expiration_date.past?) or (@view=='all') %>
  <tr>
    <td><%= chore.name %></td>
    <td><%= chore.auction.expiration_date %></td>
    <td><%= chore.due_date %></td>
    <td><%= link_to 'Show auction', chore.auction %></td>
    <td><%= link_to 'Chore details', chore %></td>
    <td><%= link_to 'Edit chore', edit_chore_path(chore) %></td>
    <td><%= link_to 'Edit auction', edit_auction_path(chore.auction) %></td>
    <td><%= link_to 'Destroy', chore, :method => :delete, :data => { :confirm => 'Are you sure?' } %></td>
    <td><%= link_to 'Take', "chores/take/"+chore.id.to_s %></td>
  </tr>
  <% end %>
<% end %>
</table>

<%= link_to 'New chore', new_chore_path %>
<%= link_to 'New auction (from existing chore)', new_auction_path %>
